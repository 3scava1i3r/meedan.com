<!-- Including InstantSearch.js library and styling -->
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.css@7/themes/algolia-min.css">

<script>
// Instanciating InstantSearch.js with Algolia credentials
const search = instantsearch({
  indexName: 'meedan.com',
  searchClient: algoliasearch('XVQE72Q0TQ', 'd031b4f0809f3999da155451bffba6db'),
});

const hitTemplate = function(hit) {
    let url = `{{ site.baseurl }}${hit.url}#${hit.anchor}`;
    const title = hit._highlightResult.title.value;
    if (hit.description) {
      description = hit.description;
    } else if (hit.short_description) {
      description = hit.short_description;
    } else {
      description = hit.body;
    }
    let breadcrumbs = '';
    if (hit._highlightResult.headings) {
        breadcrumbs = hit._highlightResult.headings.map(match => {
        return `<span class="post-breadcrumb">${match.value}</span>`
        }).join(' > ')
    }
    return `
    <div>
      <div class="title-container">
          <a class="title" href="${url}">${title}</a>
      </div>
      <div class="hit-description">
        ${description}
      </div>
    </div>
    `;
}


// Adding searchbar and results widgets
search.addWidgets([
  instantsearch.widgets.searchBox({
    container: '#search-searchbar',
  }),
  instantsearch.widgets.clearRefinements({
    container: '#clear-refinements',
  }),
  instantsearch.widgets.refinementList({
    container: '#filters-list',
    attribute: 'type',
    searchable: true,
  }),
  instantsearch.widgets.hits({
    container: '#search-hits',
    templates: {
      item: hitTemplate,
    },
  }),
  instantsearch.widgets.pagination({
    container: '#pagination',
  }),
]);

// Starting the search
search.start();
</script>